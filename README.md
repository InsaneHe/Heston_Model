# 文件构成 （!!!Engish version see the "README_en.md" file in this project!!!）

## main.py

**功用：**

主程序文件，负责读取数据、运行BSM和Heston模型、计算误差率、并进行可视化展示。

**依赖关系：**

依赖BSM_Model和Heston_Model类来计算期权价格。
依赖pandas和matplotlib库进行数据处理和可视化。

**重要部分：**

数据读取和预处理。
运行BSM模型和Heston模型，计算误差率。
可视化误差率随时间的变化和两个模型的平均误差率比较。

## bestpara.py

**功用：**

利用模拟退火算法寻找Heston模型的最优参数，使市场价格和模型价格的均方误差最小化。

**依赖关系：**

依赖Heston_Model类来计算期权价格。
依赖pandas库进行数据处理。

**重要部分：**

random_range函数：在一定范围内随机调整参数。
NG类：实现模拟退火算法的核心逻辑。
NGHeston类：继承自NG类，专门用于Heston模型参数优化。
SV_SA类：封装了模拟退火算法的具体实现。
getBestPara函数：读取数据并调用模拟退火算法寻找最优参数。

## Heston_Model.py

**功用：**

定义Heston模型类，用于计算期权价格。

**依赖关系：**

依赖numpy和scipy.integrate库进行数学计算。

**重要部分：**

Heston_Model类：包含初始化方法和计算期权价格的核心方法。
characteristic_function方法：计算特征函数。
integral_function方法：计算积分部分。
P_Value方法：计算p值。
Call_Value方法：计算看涨期权价格。

## BSM_Model.py

**功用：**

定义BSM模型类，用于计算期权价格。

**依赖关系：**

依赖scipy.stats和numpy库进行数学计算。

**重要部分：**

BSM_Model类：包含初始化方法和计算期权价格的核心方法。
d1和d2方法：计算中间变量d1和d2。
price方法：计算看涨或看跌期权价格。
互相的依赖关系
main.py依赖BSM_Model.py和Heston_Model.py来计算期权价格。
bestpara.py依赖Heston_Model.py来计算期权价格，并通过模拟退火算法优化Heston模型的参数。

# 运行方法

BSM模型仅需要期权本身参数，可直接调用BSM_Model.py

Heston模型除了需要期权本身参数外，还需要拟合参数，该拟合参数由bestpara.py得到。**先运行bestpara.py得到较优数据（即当前历史最优解）后，再运行main.py进行测试和绘图。**

![image-20240823161646743](https://cdn.jsdelivr.net/gh/zlh123123/MyPictures/image-20240823161646743.png)

关于数据：16年至20年上证50ETF期权数据。在这里使用了2020-6-12至2020-9-12的数据用于训练拟合参数；2020-9-12至2020-12-12的数据为测试数据。

关于训练拟合参数：[论文](./FIN20210400000_21389388.pdf)在1w多次循环后才得到结果，我这边跑了160个循环，循环越多理论上效果更好。

![image-20240823161050555](https://cdn.jsdelivr.net/gh/zlh123123/MyPictures/image-20240823161050555.png)

关于可视化绘图：

+ BSM模型与Heston模型的平均误差率随时间变化图（折线图）
+ BSM模型与Heston模型的总平均误差率比较（柱状图）

# 复杂文件bestpara.py的构成

1. **定义辅助函数**：
    - [`random_range(x, a, b)`](command:_github.copilot.openSymbolFromReferences?%5B%22random_range(x%2C%20a%2C%20b)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A10%2C%22character%22%3A4%7D%7D%5D%5D "Go to definition")：对输入的 [`x`](command:_github.copilot.openSymbolFromReferences?%5B%22x%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A10%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 增加一个随机变动量，并确保其在 `[a, b]` 范围内。
2. **定义模拟退火算法类 [`NG`](command:_github.copilot.openSymbolFromReferences?%5B%22NG%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A19%2C%22character%22%3A6%7D%7D%5D%5D "Go to definition")**：
    - [`__init__(self, func, x0)`](command:_github.copilot.openSymbolFromReferences?%5B%22__init__(self%2C%20func%2C%20x0)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：初始化算法的参数，包括初始解 [`x0`](command:_github.copilot.openSymbolFromReferences?%5B%22x0%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A29%7D%7D%5D%5D "Go to definition")、目标函数 [`func`](command:_github.copilot.openSymbolFromReferences?%5B%22func%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A23%7D%7D%5D%5D "Go to definition")、温度参数等。
    - [`T_change(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22T_change(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A69%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：温度下降函数。
    - [`save_xy(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22save_xy(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A76%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 和 [`save_best_xy(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22save_best_xy(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A80%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：保存当前解和最优解。
    - [`__p_delta(self, alpha)`](command:_github.copilot.openSymbolFromReferences?%5B%22__p_delta(self%2C%20alpha)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A84%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 和 [`__find_solver(self, func, f0)`](command:_github.copilot.openSymbolFromReferences?%5B%22__find_solver(self%2C%20func%2C%20f0)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A88%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：计算接受新解的概率和用二分法寻找方程解。
    - [`find_alpha(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22find_alpha(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A46%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition")：寻找调节概率因子 [`alpha`](command:_github.copilot.openSymbolFromReferences?%5B%22alpha%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A46%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
    - [`get_x_new(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22get_x_new(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A116%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：生成新的解。
    - [`judge(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22judge(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A121%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：判断是否接受新的解。
    - [`get_history_best_xy(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22get_history_best_xy(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A153%2C%22character%22%3A8%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A127%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition")：获取历史最优解。
    - [`plot_best(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22plot_best(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A165%2C%22character%22%3A8%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A165%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：绘制最优值变化过程。
    - [`count_times_delta_smaller(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22count_times_delta_smaller(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A172%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：统计新旧函数值之差的绝对值连续小于某值的次数。
    - [`condition_end(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22condition_end(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A186%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：判断是否满足终止条件。
    - [`run_T(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22run_T(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A197%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：在某一特定温度下进行循环。
    - [`accept_best_xf(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22accept_best_xf(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A226%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：在每个温度下的循环结束时，有一定概率将当前接受的新解替换为历史最优解。
    - [`run(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22run(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A231%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：运行模拟退火算法。
3. **定义继承自 [`NG`](command:_github.copilot.openSymbolFromReferences?%5B%22NG%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A19%2C%22character%22%3A6%7D%7D%5D%5D "Go to definition") 的 [`NGHeston`](command:_github.copilot.openSymbolFromReferences?%5B%22NGHeston%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A244%2C%22character%22%3A6%7D%7D%5D%5D "Go to definition") 类**：
    - [`__init__(self, func, x0)`](command:_github.copilot.openSymbolFromReferences?%5B%22__init__(self%2C%20func%2C%20x0)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：初始化参数，设置特定的温度参数。
    - [`get_x_new(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22get_x_new(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A116%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：生成新的解，并对 Heston 模型的参数进行范围限制。
4. **定义 [`SV_SA`](command:_github.copilot.openSymbolFromReferences?%5B%22SV_SA%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A269%2C%22character%22%3A6%7D%7D%5D%5D "Go to definition") 类**：
    - [`__init__(self, data, v0, kappa, theta, sigma, rho)`](command:_github.copilot.openSymbolFromReferences?%5B%22__init__(self%2C%20data%2C%20v0%2C%20kappa%2C%20theta%2C%20sigma%2C%20rho)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：初始化数据和初始参数。
    - [`error_mean_percent(self, init_params)`](command:_github.copilot.openSymbolFromReferences?%5B%22error_mean_percent(self%2C%20init_params)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A298%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：计算 Heston 模型期权定价的百分比误差均值。
    - [`error_mean(self, init_params)`](command:_github.copilot.openSymbolFromReferences?%5B%22error_mean(self%2C%20init_params)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A336%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：计算 Heston 模型期权定价的均方误差。
    - [`test_error_mean(self, multiple_parmas)`](command:_github.copilot.openSymbolFromReferences?%5B%22test_error_mean(self%2C%20multiple_parmas)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A368%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：计算多组初始参数的均方误差。
    - [`test_option_price(self, multiple_parmas)`](command:_github.copilot.openSymbolFromReferences?%5B%22test_option_price(self%2C%20multiple_parmas)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A383%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：计算多组期权数据和初始参数的期权价格。
    - [`sa(self)`](command:_github.copilot.openSymbolFromReferences?%5B%22sa(self)%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A417%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition")：对均方误差函数用模拟退火算法计算最优值。
5. **定义主函数 [`getBestPara()`](command:_github.copilot.openSymbolFromReferences?%5B%22getBestPara()%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A426%2C%22character%22%3A4%7D%7D%5D%5D "Go to definition")**：
    - 读取期权数据，选择指定日期和类型的数据。
    - 建立 [`SV_SA`](command:_github.copilot.openSymbolFromReferences?%5B%22SV_SA%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A269%2C%22character%22%3A6%7D%7D%5D%5D "Go to definition") 类并开始训练模型，寻找最优解。
    - 返回最优解。







**在该文件中涉及到一些复杂函数。**

### [`run`](command:_github.copilot.openSymbolFromReferences?%5B%22run%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A225%2C%22character%22%3A8%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A225%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数

#### 代码
```python
def run(self):
    while self.T > self.T_min:
        self.run_T()  # 循环在该温度下的求解
        self.xf_best_T[self.T] = [
            self.get_history_best_xy()
        ]  # 记录在每一个温度下的最优解
        self.T_change()  # 温度继续下降
        self.accept_best_xf()  # 当每个温度下的循环结束时，有一定概率将当前接受的新解替换为历史最优解
        if self.condition_end() == True:  # 如果满足终止条件，终止该温度循环
            break
```

#### 解释
[`run`](command:_github.copilot.openSymbolFromReferences?%5B%22run%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A225%2C%22character%22%3A8%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A225%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数是模拟退火算法的核心循环。它通过不断降低温度来寻找最优解。具体步骤如下：

1. **温度循环**：当当前温度 [`T`](command:_github.copilot.openSymbolFromReferences?%5B%22T%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A226%2C%22character%22%3A19%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A37%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 大于最小温度 [`T_min`](command:_github.copilot.openSymbolFromReferences?%5B%22T_min%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A226%2C%22character%22%3A28%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A39%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 时，进入循环。
2. **在当前温度下求解**：调用 [`run_T`](command:_github.copilot.openSymbolFromReferences?%5B%22run_T%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A227%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A191%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，在当前温度下进行求解。
3. **记录最优解**：将当前温度下的最优解记录在 [`xf_best_T`](command:_github.copilot.openSymbolFromReferences?%5B%22xf_best_T%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A228%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A40%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 字典中。
4. **温度下降**：调用 [`T_change`](command:_github.copilot.openSymbolFromReferences?%5B%22T_change%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A231%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A69%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，降低温度。
5. **接受最优解**：调用 [`accept_best_xf`](command:_github.copilot.openSymbolFromReferences?%5B%22accept_best_xf%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A232%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A220%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，有一定概率将当前接受的新解替换为历史最优解。
6. **终止条件**：如果满足终止条件（调用 [`condition_end`](command:_github.copilot.openSymbolFromReferences?%5B%22condition_end%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A233%2C%22character%22%3A20%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A180%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数），则跳出循环。

### [`run_T`](command:_github.copilot.openSymbolFromReferences?%5B%22run_T%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A227%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A191%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数

#### 代码
```python
def run_T(self):
    for time_ in range(self.times_max):
        self.time_ = time_
        self.x_new = self.get_x_new()  # 获得新解
        self.f_new = self.func(self.x_new)  # 获得新的函数值
        self.save_xy()  # 将新解和函数值记录下来
        self.delta = self.f_new - self.f  # 计算函数值的变化值
        self.judge()  # 判断是否接受新解
        self.times_cycle += 1  # 统计循环次数
        self.delta_best = np.abs(
            self.f - self.f_last
        )  # 上次函数值与这次函数值的差值绝对值
        self.count_times_delta_smaller()  # 统计新旧函数值之差的绝对值连续小于此值的次数
        if self.condition_end() == True:  # 如果满足终止条件，终止该温度循环
            print(
                "满足终止条件：接受新解后的函数值变化连续小于{}达到次数".format(
                    self.delta_min
                )
            )
            break
        print(
            "当前历史最优解{}：{}".format(self.f_best, self.x_best)
        )  # 展示当前最优值
        print("当前接受的新解{}：{}".format(self.f, self.x))  # 展示当前接受的新解
        print("当前新解{}：{}".format(self.f_new, self.x_new))  # 展示当前新产生的解
        print("当前温度为{}".format(self.T))  # 展示当前温度
```

#### 解释
[`run_T`](command:_github.copilot.openSymbolFromReferences?%5B%22run_T%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A227%2C%22character%22%3A17%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A191%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数在特定温度下进行循环求解。具体步骤如下：

1. **循环次数**：在每个温度下，循环 [`times_max`](command:_github.copilot.openSymbolFromReferences?%5B%22times_max%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A56%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 次。
2. **获得新解**：调用 [`get_x_new`](command:_github.copilot.openSymbolFromReferences?%5B%22get_x_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A116%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，生成新的解 [`x_new`](command:_github.copilot.openSymbolFromReferences?%5B%22x_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A123%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition")。
3. **计算新函数值**：使用目标函数 [`func`](command:_github.copilot.openSymbolFromReferences?%5B%22func%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A23%7D%7D%5D%5D "Go to definition") 计算新的函数值 [`f_new`](command:_github.copilot.openSymbolFromReferences?%5B%22f_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A125%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition")。
4. **记录新解和函数值**：调用 [`save_xy`](command:_github.copilot.openSymbolFromReferences?%5B%22save_xy%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A76%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，将新解和函数值记录下来。
5. **计算函数值变化**：计算新旧函数值的变化 [`delta`](command:_github.copilot.openSymbolFromReferences?%5B%22delta%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A122%2C%22character%22%3A16%7D%7D%5D%5D "Go to definition")。
6. **判断是否接受新解**：调用 [`judge`](command:_github.copilot.openSymbolFromReferences?%5B%22judge%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A121%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，判断是否接受新解。
7. **统计循环次数**：增加循环次数 [`times_cycle`](command:_github.copilot.openSymbolFromReferences?%5B%22times_cycle%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A57%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
8. **计算函数值差值**：计算上次函数值与这次函数值的差值绝对值 [`delta_best`](command:_github.copilot.openSymbolFromReferences?%5B%22delta_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A167%2C%22character%22%3A16%7D%7D%5D%5D "Go to definition")。
9. **统计差值次数**：调用 [`count_times_delta_smaller`](command:_github.copilot.openSymbolFromReferences?%5B%22count_times_delta_smaller%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A166%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数，统计新旧函数值之差的绝对值连续小于某值的次数。
10. **终止条件**：如果满足终止条件（调用 [`condition_end`](command:_github.copilot.openSymbolFromReferences?%5B%22condition_end%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A233%2C%22character%22%3A20%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A180%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数），则跳出循环。
11. **打印信息**：打印当前最优解、接受的新解、新产生的解和当前温度。

### [`judge`](command:_github.copilot.openSymbolFromReferences?%5B%22judge%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A121%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数

#### 代码
```python
def judge(self):
    if self.delta < 0:  # 如果函数值变动幅度小于0,则接受新解
        self.x = self.x_new
        self.f_last = self.f  # 在最优解函数值更新之前将其记录下来
        self.f = self.f_new
        self.save_best_xy()  # 记录每次循环接受的新解
        self.get_history_best_xy()  # 更新历史最优解
        self.times_stay = 0  # 由于未接受新解，将连续未接受新解的次数归零
        print(
            "由于函数值变小新接受解{}:{}".format(self.f, self.x)
        )  # 展示当前接受的新解
    else:
        p = np.exp(-self.delta / (self.T * self.alpha))  # 接受新解的概率
        p_ = np.random.random()  # 判断标准概率
        if p > p_:  # 如果概率足够大，接受新解
            self.x = self.x_new
            self.f_last = self.f  # 在接受的新解更新之前将其记录下来
            self.f = self.f_new
            self.save_best_xy()  # 记录每次循环接受的新解
            self.get_history_best_xy()  # 更新历史最优解
            print(
                "由于概率{}大于{}，新接受解{}:{}".format(p, p_, self.f, self.x)
            )  # 展示当前接受的新解
            self.times_p += 1  # 统计因为概率而接受新解的次数
            self.times_stay = 0  # 由于未接受新解，将连续未接受新解的次数归零
        else:
            if self.time_ == 0:
                self.f_last = self.f  # 在接受的新解更新之前将其记录下来
            self.times_stay += 1  # 连续接受新解次数加1
            print("连续未接受新解{}次".format(self.times_stay))
```

#### 解释
[`judge`](command:_github.copilot.openSymbolFromReferences?%5B%22judge%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A121%2C%22character%22%3A8%7D%7D%5D%5D "Go to definition") 函数用于判断是否接受新的解 [`x_new`](command:_github.copilot.openSymbolFromReferences?%5B%22x_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A123%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition")。具体步骤如下：

1. **函数值变小**：如果新函数值 [`f_new`](command:_github.copilot.openSymbolFromReferences?%5B%22f_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A125%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition") 小于当前函数值 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")，则直接接受新解。
   - 更新当前解 [`x`](command:_github.copilot.openSymbolFromReferences?%5B%22x%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A10%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 和函数值 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
   - 记录最优解。
   - 更新历史最优解。
   - 将连续未接受新解的次数 [`times_stay`](command:_github.copilot.openSymbolFromReferences?%5B%22times_stay%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A34%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 归零。
   - 打印接受的新解信息。
2. **函数值变大**：如果新函数值 [`f_new`](command:_github.copilot.openSymbolFromReferences?%5B%22f_new%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A125%2C%22character%22%3A26%7D%7D%5D%5D "Go to definition") 大于当前函数值 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")，则根据概率判断是否接受新解。
   - 计算接受新解的概率 [`p`](command:_github.copilot.openSymbolFromReferences?%5B%22p%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A133%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition")。
   - 生成一个随机概率 [`p_`](command:_github.copilot.openSymbolFromReferences?%5B%22p_%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A134%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition")。
   - 如果 [`p`](command:_github.copilot.openSymbolFromReferences?%5B%22p%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A133%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition") 大于 [`p_`](command:_github.copilot.openSymbolFromReferences?%5B%22p_%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A134%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition")，则接受新解。
     - 更新当前解 [`x`](command:_github.copilot.openSymbolFromReferences?%5B%22x%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A10%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 和函数值 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
     - 记录最优解。
     - 更新历史最优解。
     - 打印接受的新解信息。
     - 统计因为概率而接受新解的次数 [`times_p`](command:_github.copilot.openSymbolFromReferences?%5B%22times_p%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A59%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
     - 将连续未接受新解的次数 [`times_stay`](command:_github.copilot.openSymbolFromReferences?%5B%22times_stay%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A34%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 归零。
   - 如果 [`p`](command:_github.copilot.openSymbolFromReferences?%5B%22p%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A133%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition") 小于 [`p_`](command:_github.copilot.openSymbolFromReferences?%5B%22p_%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A134%2C%22character%22%3A12%7D%7D%5D%5D "Go to definition")，则不接受新解。
     - 如果是第一次循环，将当前函数值 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 记录为 [`f_last`](command:_github.copilot.openSymbolFromReferences?%5B%22f_last%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A124%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition")。
     - 增加连续未接受新解的次数 [`times_stay`](command:_github.copilot.openSymbolFromReferences?%5B%22times_stay%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A34%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
     - 打印未接受新解的次数。

### [`get_history_best_xy`](command:_github.copilot.openSymbolFromReferences?%5B%22get_history_best_xy%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A229%2C%22character%22%3A21%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A127%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 函数

#### 代码
```python
def get_history_best_xy(self):
    x_array = list(
        np.array(list(self.xf_best_all.values()),dtype=object)[:, 0]
    )  # 从历史所有的最优x和f中获得所有的x
    f_array = list(
        np.array(list(self.xf_best_all.values()),dtype=object)[:, 1]
    )  # 从历史所有的最优x和f中获得所有的f
    self.f_best = min(f_array)  # 从每阶段最优的f中获得最优的f
    self.x_best = x_array[f_array.index(self.f_best)]  # 利用最优f反推最优x
    return self.x_best, self.f_best
```

#### 解释
[`get_history_best_xy`](command:_github.copilot.openSymbolFromReferences?%5B%22get_history_best_xy%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A229%2C%22character%22%3A21%7D%7D%2C%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A127%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 函数用于获取历史最优解。具体步骤如下：

1. **获取所有历史最优解**：从 [`xf_best_all`](command:_github.copilot.openSymbolFromReferences?%5B%22xf_best_all%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A64%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 字典中提取所有的 [`x`](command:_github.copilot.openSymbolFromReferences?%5B%22x%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A10%2C%22character%22%3A17%7D%7D%5D%5D "Go to definition") 和 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
2. **找到最优函数值**：从所有的 [`f`](command:_github.copilot.openSymbolFromReferences?%5B%22f%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A29%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 中找到最小的 [`f_best`](command:_github.copilot.openSymbolFromReferences?%5B%22f_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A32%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
3. **找到对应的最优解**：根据最优函数值 [`f_best`](command:_github.copilot.openSymbolFromReferences?%5B%22f_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A32%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 找到对应的 [`x_best`](command:_github.copilot.openSymbolFromReferences?%5B%22x_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A31%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。
4. **返回最优解**：返回最优解 [`x_best`](command:_github.copilot.openSymbolFromReferences?%5B%22x_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A31%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition") 和最优函数值 [`f_best`](command:_github.copilot.openSymbolFromReferences?%5B%22f_best%22%2C%5B%7B%22uri%22%3A%7B%22%24mid%22%3A1%2C%22fsPath%22%3A%22c%3A%5C%5CUsers%5C%5CHP%5C%5CDesktop%5C%5CHeston-Model-Calibration%5C%5CModel%5C%5CBestPara.py%22%2C%22_sep%22%3A1%2C%22external%22%3A%22file%3A%2F%2F%2Fc%253A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22path%22%3A%22%2FC%3A%2FUsers%2FHP%2FDesktop%2FHeston-Model-Calibration%2FModel%2FBestPara.py%22%2C%22scheme%22%3A%22file%22%7D%2C%22pos%22%3A%7B%22line%22%3A32%2C%22character%22%3A13%7D%7D%5D%5D "Go to definition")。

